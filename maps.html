<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Albury Development Map Check</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  
  <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
  <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>

  <script src="https://unpkg.com/@turf/turf@6.5.0/turf.min.js"></script>

    <style>
    :root {
      --sidebar-w: 290px;
      --panel-bg: #ffffff;
      --panel-bd: #e5e5e5;
    }
    html, body { height: 100%; margin: 0; }
    #map { position: absolute; inset: 0; }

    
    #sidebar {
      position: absolute; top: 0; left: 0; bottom: 0;
      width: var(--sidebar-w);
      background: var(--panel-bg);
      border-right: 1px solid var(--panel-bd);
      box-shadow: 2px 0 8px rgba(0,0,0,.06);
      z-index: 1000;
      transform: translateX(0);
      transition: transform .28s ease;
      display: flex; flex-direction: column;
    }
    #sidebar.collapsed { transform: translateX(calc(-1 * var(--sidebar-w))); }

    #sidebar .hdr {
      display: flex; align-items: center; justify-content: space-between;
      padding: 12px 12px; border-bottom: 1px solid var(--panel-bd);
      font: 600 16px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    #sidebar .hdr a { color:#0077cc; text-decoration:none; font-weight:600; }
    #sidebar .body { padding: 10px 12px; overflow: auto; }

    #burger {
      position: absolute; top: 12px; left: 12px; z-index: 1100;
      background: var(--panel-bg); border: 1px solid var(--panel-bd);
      border-radius: 8px; padding: 6px 10px; cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,.05);
      font: 600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    
    .chips {
      position: absolute; top: 12px; right: 12px; z-index: 1100;
      background: var(--panel-bg); border: 1px solid var(--panel-bd);
      border-radius: 10px; padding: 8px 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,.05);
      display: flex; gap: 6px; flex-wrap: wrap; align-items: center; max-width: 50vw;
      font: 13px/1.2 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    .chip { padding: 3px 10px; border-radius: 999px; border: 1px solid; white-space: nowrap; }
    .ok  { background:#eaf7ea; color:#1b5e20; border-color:#b6e3b6; }
    .bad { background:#fdecea; color:#8a130c; border-color:#f5c6c3; }

    .note {
      position: absolute; bottom: 12px; left: 12px; z-index: 1100;
      background: var(--panel-bg); border: 1px solid var(--panel-bd);
      border-radius: 8px; padding: 6px 10px; color:#666;
      font: 12px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }

    
    .sidebar-open .leaflet-left { left: calc(var(--sidebar-w) + 12px) !important; }
    .leaflet-top.leaflet-left { margin-top: 52px; } 
    @media (max-width: 640px){
      .chips { max-width: 78vw; }
    }

    
    .sec { border-bottom: 1px solid var(--panel-bd); }
    .sec h4 {
      margin: 0; padding: 10px 6px; cursor: pointer; user-select: none;
      font: 600 14px system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      display:flex; align-items:center; justify-content:space-between;
    }
    .sec .content { padding: 8px 6px 12px; display: none; }
    .sec.open .content { display: block; }
    .muted { color:#666; font-size:12px; margin:6px 0 0 6px; }
    .sec h4 .caret { transition: transform .2s ease; }
    .sec.open h4 .caret { transform: rotate(90deg); }
  </style>

</head>
<body class="sidebar-open">

<div id="sidebar">
    <div class="hdr">
      <span>Layers</span>
      <a id="backLink" href="property.html">← Back</a>
    </div>
    <div class="body">
     
      <div class="muted">Use the search box on the map to find an address, or click anywhere to drop a pin.</div>

      
      <div class="sec open" id="sec-planning">
        <h4><span>Planning overlays</span><span class="caret">▶</span></h4>
        <div class="content">
          <label><input type="checkbox" id="tHeritage" checked> Heritage Areas</label><br>
          <label><input type="checkbox" id="tBushfire" checked> Bushfire-prone</label><br>
          <label><input type="checkbox" id="tFlood" checked> Flood Zones</label><br>
          <label><input type="checkbox" id="tSlope" checked> Steep Slope</label><br>
        </div>
      </div>

      
      <div class="sec" id="sec-basemaps">
        <h4><span>Base maps</span><span class="caret">▶</span></h4>
        <div class="content" id="basemapRadios">
        </div>
      </div>

    </div>
  </div>

  <button id="burger">☰ Layers</button>

  
  <div class="chips" id="chips"></div>

  
  <div id="map"></div>

<script>
const HERITAGE_AREAS = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"name":"Heritage Precinct A"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [146.9080,-36.0860],[146.9185,-36.0860],[146.9185,-36.0790],[146.9080,-36.0790],[146.9080,-36.0860]
        ]]
      }
    }
  ]
};

const BUSHFIRE_ZONES = {   
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"cat":"BFZ"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [146.9250,-36.0950],[146.9450,-36.0950],[146.9450,-36.0800],[146.9250,-36.0800],[146.9250,-36.0950]
        ]]
      }
    }
  ]
};

const FLOOD_ZONES = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"cat":"Floodway"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [146.9100,-36.0950],[146.9300,-36.0950],[146.9300,-36.0850],[146.9100,-36.0850],[146.9100,-36.0950]
        ]]
      }
    }
  ]
};

const STEEP_SLOPE = {
  "type":"FeatureCollection",
  "features":[
    {
      "type":"Feature",
      "properties":{"slope":">15°"},
      "geometry":{
        "type":"Polygon",
        "coordinates":[[
          [146.9000,-36.0800],[146.9100,-36.0800],[146.9100,-36.0725],[146.9000,-36.0725],[146.9000,-36.0800]
        ]]
      }
    }
  ]
};
</script>

<script>
    (function syncBack(){
      const id = new URLSearchParams(location.search).get('id');
      const back = document.getElementById('backLink');
      back.href = id ? `property.html?id=${encodeURIComponent(id)}` : 'property.html';
    })();

    const sidebar = document.getElementById('sidebar');
    const burger  = document.getElementById('burger');
    function toggleSidebar(){
      sidebar.classList.toggle('collapsed');
      document.body.classList.toggle('sidebar-open');
      setTimeout(() => map.invalidateSize(), 300); 
    }
    burger.addEventListener('click', toggleSidebar);

    document.querySelectorAll('.sec h4').forEach(h => {
      h.addEventListener('click', () => h.parentElement.classList.toggle('open'));
    });

    const basemaps = {
      "OpenStreetMap": L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom:19 }),
      "Satellite":     L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', { maxZoom:19 }),
      "Topographic":   L.tileLayer('https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png', { maxZoom:17 })
    };

     const map = L.map('map', {
      center: [-36.08, 146.92],
      zoom: 13,
      layers: [basemaps["OpenStreetMap"]],
      zoomControl: true
    });

    const geocoder = L.Control.geocoder({ defaultMarkGeocode: false})
      .on('markgeocode', (e) => {
        const c = e.geocode.center;
        placeOrMoveMarker(c);
        map.setView(c, 16);
      } )
      .addTo(map);

    const heritageLayer = L.geoJSON(HERITAGE_AREAS, { style:{ color:'#8e44ad', weight:2, fillOpacity:.2 }});
    const bushfireLayer = L.geoJSON(BUSHFIRE_ZONES, { style:{ color:'#e67e22', weight:2, fillOpacity:.2 }});
    const floodLayer    = L.geoJSON(FLOOD_ZONES,    { style:{ color:'#2980b9',  weight:2, fillOpacity:.2 }});
    const slopeLayer    = L.geoJSON(STEEP_SLOPE,    { style:{ color:'#27ae60',  weight:2, fillOpacity:.2 }});

    heritageLayer.addTo(map);
    bushfireLayer.addTo(map);
    floodLayer.addTo(map);
    slopeLayer.addTo(map);

    document.getElementById('tHeritage').onchange = e => e.target.checked ? heritageLayer.addTo(map) : map.removeLayer(heritageLayer);
    document.getElementById('tBushfire').onchange = e => e.target.checked ? bushfireLayer.addTo(map) : map.removeLayer(bushfireLayer);
    document.getElementById('tFlood').onchange    = e => e.target.checked ? floodLayer.addTo(map)    : map.removeLayer(floodLayer);
    document.getElementById('tSlope').onchange    = e => e.target.checked ? slopeLayer.addTo(map)    : map.removeLayer(slopeLayer);



  </script>


</body>
</html>
